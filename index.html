<!DOCTYPE html>
<html lang="en">
<head></head>
<body>

<script>
alert("Start?")
 /* function overflow() {
    let bufferArray = [];
    for (var i = 0; i < 32000; i++) {
        bufferArray.push(new ArrayBuffer(1000000));
        if (bufferArray.length > 1000) {
            bufferArray = [];
        }
    }
} */
  

//overflow()
    function memExh() {
    let bufferArray = [];
    for (let i = 0; i < 8192; i++) {
        bufferArray.push(new ArrayBuffer(1000000)); // Allocate large buffers
        if (bufferArray.length > 1000) {
            bufferArray = []; // Clear buffer array to exhaust memory
        }
    }
}

function unkown() {
    let largeString = "A".repeat(1000000); // 1 million A's
    let nestedArray = [];
    let obj = {};
    let iterationCount = 0; // Counter to track number of iterations
    let accessResults = []; // Array to store results

    while (true) {
        // String concatenation
        largeString += largeString;
        if (largeString.length > 100000000) {
            largeString = "A".repeat(1000000); // Reset string to avoid overflow
        }

        memExh(); // Exhaust memory

        // Nested arrays
        nestedArray.push([]);
        if (nestedArray.length > 1000) {
            nestedArray = []; // Clear nested arrays to exhaust memory
        }

        // Increment iteration counter
        iterationCount++;

        // Test memory access and store results after 100 iterations
        if (iterationCount === 100) {
            try {
                // Test accessing out-of-bounds index
                let buffer = new ArrayBuffer(10); // Small buffer for demonstration
                let view = new Uint8Array(buffer);
                let outOfBoundsValue = view[view.length + 1]; // Access beyond allocated memory
                accessResults.push("Out-of-bounds value: " + outOfBoundsValue);
            } catch (e) {
                accessResults.push("Error accessing out-of-bounds memory: " + e.message);
            }

            // Break the loop after storing results
            break;
        }
    }

    // Display collected results after the loop
    for (let result of accessResults) {
        alert(result);
    }
}

unkown(); // Call the function to start testing


</script>
</body>
</html>
